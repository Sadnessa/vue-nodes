var ge=Object.defineProperty;var ie=Object.getOwnPropertySymbols;var ye=Object.prototype.hasOwnProperty,_e=Object.prototype.propertyIsEnumerable;var ue=(e,n,t)=>n in e?ge(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,Z=(e,n)=>{for(var t in n||(n={}))ye.call(n,t)&&ue(e,t,n[t]);if(ie)for(var t of ie(n))_e.call(n,t)&&ue(e,t,n[t]);return e};import{r as D,u as C,o as ee,a as ae,c as T,w as te,d as N,b as v,e as _,f as P,g as F,n as H,h as W,i as ne,j as he,F as E,k as L,t as O,l as b,m as M,p as g,q as x,s as Y,v as U,x as le,y as ce,z as A,A as de,S as $e,B as Ce,C as xe,D as be,E as ke,G as Pe,H as we}from"./vendor.fbaa8274.js";const De=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function t(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerpolicy&&(a.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?a.credentials="include":r.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(r){if(r.ep)return;r.ep=!0;const a=t(r);fetch(r.href,a)}};De();const me=e=>{const n=D({x:0,y:0}),t=D({x:0,y:0}),o=D({left:!1,middle:!1,right:!1}),r=C(e)||window,a=d=>{d.button===1&&(o.value.left=!0),d.button===4&&(o.value.middle=!0),d.button===2&&(o.value.right=!0)},i=d=>{d.button===1&&(o.value.left=!1),d.button===4&&(o.value.middle=!1),d.button===2&&(o.value.right=!1)},s=d=>{n.value={x:d.x,y:d.y},t.value={x:d.movementX,y:d.movementY}};ee(()=>{r.addEventListener("mousedown",a),r.addEventListener("mouseup",i),r.addEventListener("mousemove",s)});const u=()=>r.getBoundingClientRect?r.getBoundingClientRect():{width:window.innerWidth,height:window.innerHeight},p=()=>{if(!r)return{x:0,y:0};const{width:d,height:l}=u();return{x:n.value.x-d/2,y:n.value.y-l/2}};return ae(()=>{r.removeEventListener("mousedown",a),r.removeEventListener("mouseup",i),r.removeEventListener("mousemove",s)}),r.oncontextmenu=d=>d.preventDefault(),{mouse:n,mousemove:t,buttons:o,normalize:p}},Re={max:10,min:-10,speed:.1},Ne=(e,n)=>{const t=D(0),o=T(()=>C(e)||window),{max:r,min:a,speed:i}=Z(Z({},Re),n),s=u=>{const p=u.deltaY/Math.abs(u.deltaY),d=t.value+i*p;d>r||d<a||(t.value=d)};return ee(()=>{o.value.addEventListener("wheel",s)}),te(o,(u,p)=>{p.removeEventListener("wheel",s),u.addEventListener("wheel",s)}),{scroll:t}};const Se=N({props:{moveButton:{type:String,default:"right"}},setup(e){const n=e,t=D({x:0,y:0}),{mousemove:o,buttons:r,normalize:a}=me(),i=D(),{scroll:s}=Ne(i,{max:.7,min:0,speed:.1}),u=T(()=>1-s.value),p=T(()=>{const d=t.value.x/(1/u.value),l=t.value.y/(1/u.value);return{transform:`translateX(${d}px) translateY(${l}px) scale(${u.value}) translateX(-50%) translateY(-50%)`}});return te(o,d=>{r.value[n.moveButton]&&(t.value.x+=d.x*(1/u.value),t.value.y+=d.y*(1/u.value))}),(d,l)=>(v(),_("div",{class:"nodes-scroll-wrapper",ref_key:"scrollWrapperRef",ref:i},[P("div",{class:"nodes-scroll-wrapper__content",style:ne(C(p))},[F(d.$slots,"default",H(W({position:t.value,scale:C(u)})))],4)],512))}}),Be=()=>{let e=D([]);const n=t=>{t&&e.value.push(t)};return he(()=>{e.value=[]}),{itemRefs:e,setItemRef:n}},oe=(e,n,t)=>[T({get(){return e[n]},set(o){t(`update:${n}`,o)}})];const qe=["onMouseenter","onMouseleave"],Me={class:"nodes-canvas__node-content"},Ve=N({props:{nodes:{type:Array,required:!0}},emits:["update:nodes","update:hovered","update:selected","update:mouse"],setup(e,{emit:n}){const t=e,o=D(),[r]=oe(t,"nodes",n),{itemRefs:a,setItemRef:i}=Be(),s=D(-1),u=D(-1);let p=-1;const d=$=>{u.value=$,clearTimeout(p)},l=$=>{u.value=-1,p=window.setTimeout(()=>s.value=-1,2e3)},h=D({x:0,y:0}),k=$=>{if(u.value===-1)return;const{x:c,y:m}=a.value[u.value].getBoundingClientRect();h.value={x:$.x-c,y:$.y-m},s.value=u.value},y=()=>{s.value=-1},w=$=>{if(s.value===-1)return;const{x:c,y:m,width:f,height:R}=o.value.getBoundingClientRect(),{width:S,height:q}=a.value[s.value].getBoundingClientRect(),I={x:o.value.offsetWidth/f,y:o.value.offsetHeight/R},J={x:$.x-c-f/2+S/2,y:$.y-m-R/2+q/2},Q={x:(J.x-h.value.x)*I.x,y:(J.y-h.value.y)*I.y},j=r.value[s.value];j.position=Q},B=$=>{const c=$.position||{x:0,y:0};return{transform:`translateX(${c.x}px) translateY(${c.y}px) translateX(-50%) translateY(-50%)`}};return($,c)=>(v(),_("div",{class:"nodes-canvas",ref_key:"canvas",ref:o,onMousemove:w,onMousedown:k,onMouseup:y},[(v(!0),_(E,null,L(C(r),(m,f)=>(v(),_("div",{key:f,class:"nodes-canvas__node",ref_for:!0,ref:C(i),style:ne(B(m))},[F($.$slots,"node",H(W({node:m,index:f,listeners:{mouseenter:()=>d(f),mouseleave:()=>l()}})),()=>[P("div",{onMouseenter:R=>d(f),onMouseleave:R=>l()},[F($.$slots,"node-content",H(W({node:m,index:f})),()=>[P("div",Me,O(m),1)])],40,qe)])],4))),128))],544))}});const Ee=N({props:{connections:{type:Array,required:!0},drawFn:{type:Function,default:(e,n,t)=>{e.beginPath(),e.moveTo(n.x,n.y),e.lineTo(t.x,t.y),e.stroke()}}},setup(e){const n=e,t=D(),o=D(),r=l=>"$el"in l||l.$el!==void 0?l.$el:l,a=l=>{if(!l)return{x:0,y:0};if("x"in l&&"y"in l)return l;const h=r(l),{x:k,y,width:w,height:B}=h.getBoundingClientRect();return{x:k+w/2,y:y+B/2}},i=(l,h,k)=>({x:(l.x-h.x)*k.x,y:(l.y-h.y)*k.y}),s=()=>{var f,R;if(!t.value)return;const l=o.value,h=((f=t.value)==null?void 0:f.width)||0,k=((R=t.value)==null?void 0:R.height)||0;l.lineWidth=12,l.strokeStyle="gray",l.clearRect(0,0,h,k);const{x:y,y:w,width:B,height:$}=t.value.getBoundingClientRect(),c={x:y,y:w},m={x:t.value.offsetWidth/B,y:t.value.offsetHeight/$};n.connections.forEach(S=>{const q=a(S.start),I=a(S.end);n.drawFn(l,i(q,c,m),i(I,c,m))})},u=()=>{requestAnimationFrame(()=>{s(),u()})},p=()=>{if(!t.value)return;const{width:l,height:h}=t.value.getBoundingClientRect();t.value.height=h,t.value.width=l};let d;return ee(()=>{!t.value||(p(),o.value=t.value.getContext("2d"),u(),d=new ResizeObserver(p),d.observe(t.value))}),ae(()=>{d.disconnect()}),(l,h)=>(v(),_("canvas",{ref_key:"canvas",ref:t},null,512))}});var X;(function(e){e.Mouse="node-point:mouse"})(X||(X={}));const Fe=e=>{if(!!e)return"$el"in e?e.$el:e},Le=(e,n=window)=>{const{mouse:t}=me(n),o=(s,u)=>{const p=s.points[u];if(!p)throw new Error(`Point ${u} not found in ${s}`);return p.el?p.el:null},r=s=>s===X.Mouse?t.value:o(s.node,s.point),a=s=>s.map(({start:u,end:p})=>({start:r(u)||{x:0,y:0},end:r(p)||{x:0,y:0}}));return{connectionPoints:T(()=>a(e.value))}},G=e=>{const n=(c,m)=>f=>{c.points[m].el=Fe(f)},t=(c,m,f)=>typeof c=="string"?!1:f?c.node===m&&c.point===f:c.node===m,o=(c,m)=>e.value.find(({start:f})=>t(f,c,m)),r=(c,m)=>e.value.find(({start:f})=>t(f,c,m)),a=(c,m)=>o(c,m)||r(c,m),i=(c,m,f,R)=>e.value.find(({start:S,end:q})=>typeof S!="string"&&typeof q!="string"&&(!c||c===S.node)&&(!m||m===S.point)&&(!f||f===q.node)&&(!R||R===q.point)),s=c=>e.value.find(m=>typeof m.end!="string"&&typeof m.start!="string"&&c(m)),u=D(),p=()=>{e.value=e.value.filter(c=>c!==u.value),u.value=void 0},d=(c,m)=>{u.value&&p(),u.value={start:{node:c,point:m},end:X.Mouse},e.value.push(u.value)},l=(c,m)=>{w(c,m),!!u.value&&(u.value.end={node:c,point:m},u.value=void 0)},h=(c,m,f,R)=>{e.value=e.value.filter(({start:S,end:q})=>!(t(S,c,m)&&t(q,f,R)))},k=(c,m,f,R)=>{e.value=e.value.filter(({start:S,end:q})=>!(t(S,c,m)&&t(q,f,R))&&!(t(S,f,R)&&t(q,c,m)))},y=(c,m)=>{e.value=e.value.filter(({start:f})=>!t(f,c,m))},w=(c,m)=>{e.value=e.value.filter(({end:f})=>!t(f,c,m))};return{registerPoint:n,getConnection:a,getConnectionStart:o,getConnectionEnd:r,connectFrom:d,connectTo:l,disconnect:h,disconnectSymmetric:k,disconnectStart:y,disconnectEnd:w,searchConnection:i,findConnection:s,recursivePath:(c,m,f)=>{var S,q;if(f=f||((q=(S=e.value.concat().reverse().find(I=>typeof I.end!="string"))==null?void 0:S.end)==null?void 0:q.node),!f)return m;const R=I=>I?c({node:I,prev:Q=>{var j;return R((j=i(void 0,void 0,I,Q))==null?void 0:j.start.node)}}):m;return R(f)},isNodeConnection:c=>typeof c.end!="string"&&typeof c.start!="string"}};var re=(e,n)=>{const t=e.__vccOpts||e;for(const[o,r]of n)t[o]=r;return t};const Te=N({components:{ScrollWrapper:Se,DraggableNodes:Ve,ConnectionsCanvas:Ee},props:{nodes:{type:Array,required:!0},connections:{type:Array,required:!0},moveButton:{type:String,default:"right"}},emits:["update:nodes","update:connections","update:mouse"],setup(e,{emit:n}){const[t]=oe(e,"nodes",n),[o]=oe(e,"connections",n),r=D(),{connectionPoints:a}=Le(o,r.value);return{syncNodes:t,connectionPoints:a}}});function Ie(e,n,t,o,r,a){const i=b("DraggableNodes"),s=b("ConnectionsCanvas"),u=b("ScrollWrapper");return v(),M(u,{moveButton:e.moveButton,class:"nodes"},{default:g(()=>[x(i,{nodes:e.syncNodes,"onUpdate:nodes":n[0]||(n[0]=p=>e.syncNodes=p)},{node:g(({node:p,index:d,listeners:l})=>[F(e.$slots,"node",H(W({node:p,index:d,dragListeners:l})))]),"node-content":g(({node:p,index:d})=>[F(e.$slots,"node-content",H(W({node:p,index:d})))]),_:3},8,["nodes"]),x(s,{connections:e.connectionPoints,ref:"connectionsRef",class:"nodes__connections-canvas"},null,8,["connections"])]),_:3},8,["moveButton"])}var pe=re(Te,[["render",Ie]]);const Oe={},Ue={class:"app-sidebar"},Ae={class:"app-sidebar__top"},ze=P("h1",null,"Vue nodes demo",-1),He={class:"app-sidebar__links"},We=Y(" Calculator demo "),je=Y(" Shader demo "),Ye=P("div",{class:"app-sidebar__bottom"},[P("a",{href:"https://github.com/m0ksem/vue-nodes"},"Github")],-1);function Xe(e,n){const t=b("router-link");return v(),_("div",Ue,[P("div",Ae,[x(t,{to:"/"},{default:g(()=>[ze]),_:1}),P("div",He,[P("p",null,[x(t,{to:{name:"CalculatorDemo"},"active-class":"app-sidebar__link--active"},{default:g(()=>[We]),_:1})]),P("p",null,[x(t,{to:{name:"ShaderDemo"},"active-class":"app-sidebar__link--active"},{default:g(()=>[je]),_:1})])]),F(e.$slots,"default")]),Ye])}var Ge=re(Oe,[["render",Xe]]);const Ke={class:"app-layout"},Je={class:"app-page"},se=N({setup(e){return(n,t)=>(v(),_("div",Ke,[x(Ge,null,{default:g(()=>[F(n.$slots,"sidebar")]),_:3}),P("div",Je,[F(n.$slots,"default")])]))}}),Qe=P("p",null,"This is a math example, where you can create math expressions.",-1),Ze=P("p",null,'You have two "Number" inputs and can connect them trough math nodes.',-1),et={key:0},tt=["onUpdate:modelValue"],nt=N({setup(e){const n=D([{position:{x:-300,y:-100},math:"input",title:"Number",points:{output:{type:"output"}},value:0},{position:{x:-300,y:100},math:"input",title:"Number",points:{output:{type:"output"}},value:0},{position:{x:0,y:100},math:"+",title:"Sum",points:{input1:{type:"input",title:"Number"},input2:{type:"input",title:"Number"},output:{type:"output"}}},{position:{x:0,y:-100},math:"*",title:"Mul",points:{input1:{type:"input",title:"Number"},input2:{type:"input",title:"Number"},output:{type:"output"}}},{position:{x:150,y:0},math:"print",title:"Output",points:{input:{type:"input"}}}]),t=D([]),{registerPoint:o,connectFrom:r,connectTo:a,searchConnection:i,disconnectEnd:s}=G(t),u=()=>{const d=t.value.find(h=>typeof h.end!="string"&&h.end.node.math==="print"),l=h=>{if(h===void 0||typeof h.end=="string"||typeof h.start=="string")return 0;const k=h.start.node;if(k.math==="+"){const y=l(i(void 0,"output",k,"input1")),w=l(i(void 0,"output",k,"input2"));return y===void 0||w===void 0?0:Number(y)+Number(w)}if(k.math==="*"){const y=l(i(void 0,"output",k,"input1")),w=l(i(void 0,"output",k,"input2"));return y===void 0||w===void 0?0:Number(y)*Number(w)}if(k.math==="input")return k.value};return l(d)},p=T(()=>u());return(d,l)=>{const h=b("DemoButton"),k=b("DemoNode");return v(),M(se,null,{sidebar:g(()=>[Qe,Ze]),default:g(()=>[x(C(pe),{nodes:n.value,"onUpdate:nodes":l[0]||(l[0]=y=>n.value=y),connections:t.value,"onUpdate:connections":l[1]||(l[1]=y=>t.value=y)},{"node-content":g(({node:y})=>[x(k,{title:y.title},{inputs:g(()=>[(v(!0),_(E,null,L(y.points,(w,B)=>(v(),_(E,{key:B},[w.type==="input"?(v(),M(h,{key:0,onRegisterPoint:$=>C(o)(y,B)($),onCircleClick:$=>{C(s)(y,B),C(a)(y,B)},color:"linear-gradient(145deg, #ff4e50, #f9d423)",title:w.title},{default:g(()=>[y.math==="print"?(v(),_("div",et,O(C(p)),1)):U("",!0)]),_:2},1032,["onRegisterPoint","onCircleClick","title"])):U("",!0)],64))),128))]),outputs:g(()=>[(v(!0),_(E,null,L(y.points,(w,B)=>(v(),_(E,{key:B},[w.type==="output"?(v(),M(h,{key:0,onRegisterPoint:$=>C(o)(y,B)($),onCircleClick:$=>C(r)(y,B),color:"linear-gradient(to right, #1d976c, #93f9b9)",title:w.title,right:""},{default:g(()=>[y.value!==void 0?le((v(),_("input",{key:0,"onUpdate:modelValue":$=>y.value=$},null,8,tt)),[[ce,y.value]]):U("",!0)]),_:2},1032,["onRegisterPoint","onCircleClick","title"])):U("",!0)],64))),128))]),_:2},1032,["title"])]),_:1},8,["nodes","connections"])]),_:1})}}}),ot=N({setup(e){return(n,t)=>(v(),M(se))}}),z=e=>e,rt=N({props:{node:{type:Object,required:!0},registerPoint:{type:Function,required:!0}},emits:{"register-point":(e,n)=>!0,"connect-to":e=>!0,"connect-from":e=>!0},setup(e){return(n,t)=>{const o=b("DemoButton"),r=b("DemoNode");return v(),M(r,{title:e.node.title},{inputs:g(()=>[(v(),_(E,null,L(["in"],a=>x(o,{key:a,color:"linear-gradient(145deg, #ff4e50, #f9d423)",onRegisterPoint:i=>e.registerPoint(e.node,a)(i),onCircleClick:i=>n.$emit("connect-to",a)},null,8,["onRegisterPoint","onCircleClick"])),64))]),outputs:g(()=>[(v(),_(E,null,L(["out"],a=>x(o,{key:a,color:"linear-gradient(to right, #1d976c, #93f9b9)",right:"",onRegisterPoint:i=>e.registerPoint(e.node,a)(i),onCircleClick:i=>n.$emit("connect-from",a)},null,8,["onRegisterPoint","onCircleClick"])),64))]),_:1},8,["title"])}}}),st=e=>{const n=[];return e.forEach(t=>{n.find(o=>o.name===t.name)||n.push(t)}),n.map(t=>`uniform ${t.type} ${t.name};`).join(`
`)},it=(e={x:0,y:0})=>z({position:e,points:{in:{},out:{}},name:"fragment-shader",title:"Fragment Shader",component:A(rt),value:{},generate:({prev:n,node:t})=>{const o=n();if(!o)return{};const{code:r,uniforms:a}=o;let i="precision highp float;";return a&&(i+=`
`,i+=st(a)),i+=`
void main() {
  gl_FragColor = ${r};
}   
`,{code:i,uniforms:a}}}),ut=N({props:{node:{type:Object,required:!0},registerPoint:{type:Function,required:!0}},emits:{"register-point":(e,n)=>!0,"connect-to":e=>!0,"connect-from":e=>!0},setup(e){return(n,t)=>{const o=b("DemoInput"),r=b("DemoButton"),a=b("DemoNode");return v(),M(a,{title:e.node.title},{inputs:g(()=>[(v(),_(E,null,L(["in"],i=>x(r,{key:i,color:"linear-gradient(145deg, #ff4e50, #f9d423)",onRegisterPoint:s=>e.registerPoint(e.node,i)(s),onCircleClick:s=>n.$emit("connect-to",i)},{default:g(()=>[x(o,{modelValue:e.node.value.fn,"onUpdate:modelValue":t[0]||(t[0]=s=>e.node.value.fn=s)},null,8,["modelValue"])]),_:2},1032,["onRegisterPoint","onCircleClick"])),64))]),outputs:g(()=>[(v(),_(E,null,L(["out"],i=>x(r,{key:i,color:"linear-gradient(to right, #1d976c, #93f9b9)",right:"",onRegisterPoint:s=>e.registerPoint(e.node,i)(s),onCircleClick:s=>n.$emit("connect-from",i)},null,8,["onRegisterPoint","onCircleClick"])),64))]),_:1},8,["title"])}}}),ve=(e={x:0,y:0})=>z({position:e,points:{in:{},out:{}},name:"math",title:"Math",component:A(ut),value:{fn:"sin"},generate:({prev:n,node:t})=>{const o=n();return o?{code:`${t.value.fn}(${o.code})`,uniforms:o.uniforms}:{}}});const at={key:0,class:"demo-node-shader-source"},lt={key:1},ct=N({props:{node:{type:Object,required:!0},registerPoint:{type:Function,required:!0},connections:{type:Array,required:!0}},emits:{"register-point":(e,n)=>!0,"connect-to":e=>!0,"connect-from":e=>!0},setup(e){const n=e,{recursivePath:t}=G(de(n,"connections")),o=T(()=>{const r=t(a=>n.node.generate(a),{},n.node);return r==null?void 0:r.code});return(r,a)=>{const i=b("DemoButton"),s=b("DemoNode");return v(),M(s,{title:e.node.title},{inputs:g(()=>[(v(),_(E,null,L(["in"],u=>x(i,{key:u,color:"linear-gradient(145deg, #ff4e50, #f9d423)",onRegisterPoint:p=>e.registerPoint(e.node,u)(p),onCircleClick:p=>r.$emit("connect-to",u)},null,8,["onRegisterPoint","onCircleClick"])),64))]),outputs:g(()=>[(v(),_(E,null,L(["out"],u=>x(i,{key:u,color:"linear-gradient(to right, #1d976c, #93f9b9)",right:"",onRegisterPoint:p=>e.registerPoint(e.node,u)(p),onCircleClick:p=>r.$emit("connect-from",u)},null,8,["onRegisterPoint","onCircleClick"])),64))]),default:g(()=>[C(o)?(v(),_("div",at,O(C(o)),1)):(v(),_("div",lt," Connect some node "))]),_:1},8,["title"])}}}),dt=(e={x:0,y:0})=>z({position:e,points:{in:{},out:{}},name:"source",title:"Source",component:A(ct),value:{},generate:({prev:n,node:t})=>{const o=n();return t.name==="source"?o||{}:t.generate({prev:n,node:t})}}),mt={style:{"margin-right":"8px"}},pt=N({props:{node:{type:Object,required:!0},registerPoint:{type:Function,required:!0}},emits:{"register-point":(e,n)=>!0,"connect-to":e=>!0,"connect-from":e=>!0},setup(e){return(n,t)=>{const o=b("DemoButton"),r=b("DemoInput"),a=b("DemoNode");return v(),M(a,{title:e.node.title},{outputs:g(()=>[x(o,{color:"linear-gradient(to right, #1d976c, #93f9b9)",right:"",onRegisterPoint:t[0]||(t[0]=i=>e.registerPoint(e.node,"out")(i)),onCircleClick:t[1]||(t[1]=i=>n.$emit("connect-from","out"))})]),inputs:g(()=>[(v(),_(E,null,L(["speed"],i=>x(o,{key:i,color:"linear-gradient(145deg, #ff4e50, #f9d423)",onRegisterPoint:s=>e.registerPoint(e.node,i)(s),onCircleClick:s=>n.$emit("connect-to",i)},{default:g(()=>[P("span",mt,O(i),1),x(r,{modelValue:e.node.value[i],"onUpdate:modelValue":s=>e.node.value[i]=s},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["onRegisterPoint","onCircleClick"])),64))]),_:1},8,["title"])}}});let fe=0;const vt=(e={x:0,y:0})=>z({position:e,points:{out:{},speed:{}},name:"u_time",title:"Time",component:A(pt),value:{speed:1},generate:({node:n})=>{let t=Date.now(),o;return{code:"u_time",uniforms:[{type:"float",name:"u_time",value:()=>(o=Date.now(),fe+=(o-t)/(100*60)*n.value.speed,t=o,fe)}]}}}),ft={style:{"margin-right":"8px",width:"10px"}},gt=N({props:{node:{type:Object,required:!0},registerPoint:{type:Function,required:!0}},emits:{"register-point":(e,n)=>!0,"connect-to":e=>!0,"connect-from":e=>!0},setup(e){return(n,t)=>{const o=b("DemoInput"),r=b("DemoButton"),a=b("DemoNode");return v(),M(a,{title:e.node.title},{inputs:g(()=>[(v(),_(E,null,L(["x","y","z","w"],i=>x(r,{key:i,color:"linear-gradient(145deg, #ff4e50, #f9d423)",onRegisterPoint:s=>e.registerPoint(e.node,i)(s),onCircleClick:s=>n.$emit("connect-to",i)},{default:g(()=>[P("span",ft,O(i),1),x(o,{modelValue:e.node.value[i],"onUpdate:modelValue":s=>e.node.value[i]=s},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["onRegisterPoint","onCircleClick"])),64))]),outputs:g(()=>[(v(),_(E,null,L(["out"],i=>x(r,{key:i,color:"linear-gradient(to right, #1d976c, #93f9b9)",right:"",onRegisterPoint:s=>e.registerPoint(e.node,i)(s),onCircleClick:s=>n.$emit("connect-from",i)},null,8,["onRegisterPoint","onCircleClick"])),64))]),_:1},8,["title"])}}}),yt=e=>e.split(".").filter(n=>n!=="").length===1,_t=e=>e.match(/^-?\d+$/)||e.match(/^\d+\.\d+$/),K=e=>{if(!(e===void 0||e===""))return _t(String(e))&&yt(String(e))?`${e}.0`:e},ht=(e={x:0,y:0})=>z({position:e,points:{x:{default:0,value:0},y:{default:0,value:0},z:{default:0,value:0},w:{default:0,value:0},out:{}},name:"vec4",title:"Vector 4",component:A(gt),value:{x:0,y:0,z:0,w:0},generate:({prev:n,node:t})=>{const o=[n("x"),n("y"),n("z"),n("w")],r=o.map(s=>s==null?void 0:s.code),a=[K(r[0]||t.value.x),K(r[1]||t.value.y),K(r[2]||t.value.z),K(r[3]||t.value.w)].filter(s=>typeof s!="undefined"),i=o.map(s=>s==null?void 0:s.uniforms).flat().filter(s=>typeof s!="undefined");return{code:`vec${a.length}(${a.join(", ")})`,uniforms:i}}});const $t=N({props:{node:{type:Object,required:!0},registerPoint:{type:Function,required:!0},connections:{type:Array,required:!0}},emits:{"register-point":(e,n)=>!0,"connect-to":e=>!0,"connect-from":e=>!0},setup(e){const n=e,{recursivePath:t,findConnection:o}=G(de(n,"connections"));T(()=>{var s;return(s=a.value.uniforms)==null?void 0:s.find(u=>u.name==="u_time")});const r=({draw:s,getUniform:u,gl:p})=>{s(()=>{var d;(d=a.value.uniforms)==null||d.forEach(l=>{l.type==="float"&&p.uniform1f(u(l.name),l.value())}),p.drawArrays(p.TRIANGLE_STRIP,0,4)})},a=T(()=>t(u=>n.node.generate(u),{},n.node)),i=T(()=>a.value.code);return(s,u)=>{const p=b("DemoButton"),d=b("DemoNode");return v(),M(d,{class:"demo-out-node",title:e.node.title},{inputs:g(()=>[x(p,{color:"linear-gradient(145deg, #ff4e50, #f9d423)",onRegisterPoint:u[0]||(u[0]=l=>e.registerPoint(e.node,"in")(l)),onCircleClick:u[1]||(u[1]=l=>s.$emit("connect-to","in"))})]),default:g(()=>[C(i)?(v(),M(C($e),{key:0,fragment:C(i),onReady:r},null,8,["fragment"])):U("",!0)]),_:1},8,["title"])}}}),Ct=(e={x:0,y:0})=>z({position:e,points:{in:{},out:{}},name:"out",title:"Out",component:A($t),value:{},generate:({prev:n,node:t})=>{const o=n();return t.name==="out"?o||{}:t.generate({prev:n,node:t})}}),V=[vt({x:-300,y:0}),(()=>{const e=ve({x:0,y:0});return e.fn="sin",e})(),(()=>{const e=ve({x:0,y:100});return e.fn="cos",e})(),(()=>{const e=ht({x:300,y:0});return e.value.z=1,e.value.w=1,e})(),it({x:-300,y:-200}),dt({x:100,y:-300}),Ct({x:500,y:300})],xt=[{start:{node:V[0],point:"out"},end:{node:V[1],point:"in"}},{start:{node:V[0],point:"out"},end:{node:V[2],point:"in"}},{start:{node:V[1],point:"out"},end:{node:V[3],point:"x"}},{start:{node:V[2],point:"out"},end:{node:V[3],point:"y"}},{start:{node:V[3],point:"out"},end:{node:V[4],point:"in"}},{start:{node:V[4],point:"out"},end:{node:V[5],point:"in"}},{start:{node:V[5],point:"out"},end:{node:V[6],point:"in"}}],bt=P("p",null,"This is a shader generator example, where you can create GLSL shader and preview it.",-1),kt=N({setup(e){const n=D(V),t=D(xt),{connectFrom:o,connectTo:r,registerPoint:a}=G(t);return(i,s)=>(v(),M(se,null,{sidebar:g(()=>[bt]),default:g(()=>[x(C(pe),{nodes:n.value,"onUpdate:nodes":s[0]||(s[0]=u=>n.value=u),connections:t.value,"onUpdate:connections":s[1]||(s[1]=u=>t.value=u)},{"node-content":g(({node:u})=>[(v(),M(Ce(u.component),{connections:t.value,node:u,"register-point":C(a),onConnectFrom:p=>C(o)(u,p),onConnectTo:p=>C(r)(u,p)},null,8,["connections","node","register-point","onConnectFrom","onConnectTo"]))]),_:1},8,["nodes","connections"])]),_:1}))}}),Pt=xe({history:be("/vue-nodes"),routes:[{path:"/",name:"index",component:ot},{path:"/shader-demo",name:"ShaderDemo",component:kt},{path:"/calculator",name:"CalculatorDemo",component:nt}]});const wt=N({props:{color:{type:String,required:!1,default:void 0},title:{type:String,required:!1,default:""},right:{type:Boolean,required:!1,default:!1}},emits:["circle-click","register-point"],setup(e,{emit:n}){const t=D();return te(t,o=>{o&&n("register-point",o)}),(o,r)=>(v(),_("div",{class:ke(["demo-button",{"demo-button--right":e.right}])},[e.right?F(o.$slots,"default",{key:0},()=>[Y(O(e.title),1)]):U("",!0),P("div",{class:"demo-button__circle",onClick:r[0]||(r[0]=a=>o.$emit("circle-click")),style:ne({background:e.color,cursor:e.color?"pointer":"default"}),ref_key:"circleRef",ref:t},null,4),e.right?U("",!0):F(o.$slots,"default",{key:1},()=>[Y(O(e.title),1)])],2))}});const Dt=N({props:{modelValue:{type:[String,Number],required:!0}},emits:["update:modelValue"],setup(e,{emit:n}){const t=e,o=T({get(){return t.modelValue},set(r){n("update:modelValue",r)}});return(r,a)=>le((v(),_("input",{"onUpdate:modelValue":a[0]||(a[0]=i=>Pe(o)?o.value=i:null)},null,512)),[[ce,C(o)]])}});const Rt={class:"demo-node"},Nt={key:0,class:"demo-node__header"},St={class:"demo-node__main"},Bt={class:"demo-node__inputs"},qt={class:"demo-node__content"},Mt={class:"demo-node__outputs"},Vt=N({props:{title:{type:String,required:!1,default:""}},setup(e){return(n,t)=>(v(),_("div",Rt,[e.title?(v(),_("div",Nt,O(e.title),1)):U("",!0),P("div",St,[P("div",Bt,[F(n.$slots,"inputs")]),P("div",qt,[F(n.$slots,"default")]),P("div",Mt,[F(n.$slots,"outputs")])])]))}}),Et={install(e){e.component("DemoButton",wt),e.component("DemoInput",Dt),e.component("DemoNode",Vt)}};const Ft={};function Lt(e,n){const t=b("router-view");return v(),M(t)}var Tt=re(Ft,[["render",Lt]]);we(Tt).use(Pt).use(Et).mount("#app");
