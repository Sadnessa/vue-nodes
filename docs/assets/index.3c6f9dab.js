var oe=Object.defineProperty;var G=Object.getOwnPropertySymbols;var se=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable;var K=(t,n,e)=>n in t?oe(t,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[n]=e,Y=(t,n)=>{for(var e in n||(n={}))se.call(n,e)&&K(t,e,n[e]);if(G)for(var e of G(n))re.call(n,e)&&K(t,e,n[e]);return t};import{r as w,u as b,o as A,a as J,c as N,w as I,d as B,b as x,e as C,f as k,g as R,n as L,h as T,i as U,j as ue,F as P,k as z,t as H,l as V,m as M,p as q,q as ie,s as E,v as Q,x as ae,y as le,z as ce,A as de}from"./vendor.7d2b1e45.js";const ve=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const v of o)if(v.type==="childList")for(const m of v.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&r(m)}).observe(document,{childList:!0,subtree:!0});function e(o){const v={};return o.integrity&&(v.integrity=o.integrity),o.referrerpolicy&&(v.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?v.credentials="include":o.crossorigin==="anonymous"?v.credentials="omit":v.credentials="same-origin",v}function r(o){if(o.ep)return;o.ep=!0;const v=e(o);fetch(o.href,v)}};ve();const Z=t=>{const n=w({x:0,y:0}),e=w({x:0,y:0}),r=w({left:!1,middle:!1,right:!1}),o=b(t)||window,v=i=>{i.button===1&&(r.value.left=!0),i.button===4&&(r.value.middle=!0),i.button===2&&(r.value.right=!0)},m=i=>{i.button===1&&(r.value.left=!1),i.button===4&&(r.value.middle=!1),i.button===2&&(r.value.right=!1)},a=i=>{n.value={x:i.x,y:i.y},e.value={x:i.movementX,y:i.movementY}};A(()=>{o.addEventListener("mousedown",v),o.addEventListener("mouseup",m),o.addEventListener("mousemove",a)});const d=()=>o.getBoundingClientRect?o.getBoundingClientRect():{width:window.innerWidth,height:window.innerHeight},f=()=>{if(!o)return{x:0,y:0};const{width:i,height:u}=d();return{x:n.value.x-i/2,y:n.value.y-u/2}};return J(()=>{o.removeEventListener("mousedown",v),o.removeEventListener("mouseup",m),o.removeEventListener("mousemove",a)}),o.oncontextmenu=i=>i.preventDefault(),{mouse:n,mousemove:e,buttons:r,normalize:f}},pe={max:10,min:-10,speed:.1},fe=(t,n)=>{const e=w(0),r=N(()=>b(t)||window),{max:o,min:v,speed:m}=Y(Y({},pe),n),a=d=>{const f=d.deltaY/Math.abs(d.deltaY),i=e.value+m*f;i>o||i<v||(e.value=i)};return A(()=>{r.value.addEventListener("wheel",a)}),I(r,(d,f)=>{f.removeEventListener("wheel",a),d.addEventListener("wheel",a)}),{scroll:e}};const me=B({props:{moveButton:{type:String,default:"right"}},setup(t){const n=t,e=w({x:0,y:0}),{mousemove:r,buttons:o,normalize:v}=Z(),m=w(),{scroll:a}=fe(m,{max:.7,min:0,speed:.1}),d=N(()=>1-a.value),f=N(()=>{const i=e.value.x/(1/d.value),u=e.value.y/(1/d.value);return{transform:`translateX(${i}px) translateY(${u}px) scale(${d.value}) translateX(-50%) translateY(-50%)`}});return I(r,i=>{o.value[n.moveButton]&&(e.value.x+=i.x*(1/d.value),e.value.y+=i.y*(1/d.value))}),(i,u)=>(x(),C("div",{class:"nodes-scroll-wrapper",ref_key:"scrollWrapperRef",ref:m},[k("div",{class:"nodes-scroll-wrapper__content",style:U(b(f))},[R(i.$slots,"default",L(T({position:e.value,scale:b(d)})))],4)],512))}}),ye=()=>{let t=w([]);const n=e=>{e&&t.value.push(e)};return ue(()=>{t.value=[]}),{itemRefs:t,setItemRef:n}},X=(t,n,e)=>[N({get(){return t[n]},set(r){e(`update:${n}`,r)}})];const _e=["onMouseenter","onMouseleave"],he={class:"nodes-canvas__node-content"},ge=B({props:{nodes:{type:Array,required:!0}},emits:["update:nodes","update:hovered","update:selected","update:mouse"],setup(t,{emit:n}){const e=t,r=w(),[o]=X(e,"nodes",n),{itemRefs:v,setItemRef:m}=ye(),a=w(-1),d=w(-1);let f=-1;const i=c=>{d.value=c,clearTimeout(f)},u=c=>{d.value=-1,f=setTimeout(()=>a.value=-1,2e3)},l=w({x:0,y:0}),y=c=>{if(d.value===-1)return;const{x:$,y:h}=v.value[d.value].getBoundingClientRect();l.value={x:c.x-$,y:c.y-h},a.value=d.value},_=()=>{a.value=-1},s=c=>{if(a.value===-1)return;const{x:$,y:h,width:g,height:S}=r.value.getBoundingClientRect(),{width:F,height:W}=v.value[a.value].getBoundingClientRect(),D={x:r.value.offsetWidth/g,y:r.value.offsetHeight/S},j={x:c.x-$-g/2+F/2,y:c.y-h-S/2+W/2},te={x:(j.x-l.value.x)*D.x,y:(j.y-l.value.y)*D.y},ne=o.value[a.value];ne.position=te},p=c=>{const $=c.position||{x:0,y:0};return{transform:`translateX(${$.x}px) translateY(${$.y}px) translateX(-50%) translateY(-50%)`}};return(c,$)=>(x(),C("div",{class:"nodes-canvas",ref_key:"canvas",ref:r,onMousemove:s,onMousedown:y,onMouseup:_},[(x(!0),C(P,null,z(b(o),(h,g)=>(x(),C("div",{key:g,class:"nodes-canvas__node",ref_for:!0,ref:b(m),style:U(p(h))},[R(c.$slots,"node",L(T({node:h,index:g,listeners:{mouseenter:()=>i(g),mouseleave:()=>u()}})),()=>[k("div",{onMouseenter:S=>i(g),onMouseleave:S=>u()},[R(c.$slots,"node-content",L(T({node:h,index:g})),()=>[k("div",he,H(h),1)])],40,_e)])],4))),128))],544))}});const xe=B({props:{connections:{type:Array,required:!0},drawFn:{type:Function,default:(t,n,e)=>{t.beginPath(),t.moveTo(n.x,n.y),t.lineTo(e.x,e.y),t.stroke()}}},setup(t){const n=t,e=w(),r=w(),o=u=>"$el"in u||u.$el!==void 0?u.$el:u,v=u=>{if(!u)return{x:0,y:0};if("x"in u&&"y"in u)return u;const l=o(u),{x:y,y:_,width:s,height:p}=l.getBoundingClientRect();return{x:y+s/2,y:_+p/2}},m=(u,l,y)=>({x:(u.x-l.x)*y.x,y:(u.y-l.y)*y.y}),a=()=>{var g,S;if(!e.value)return;const u=r.value,l=((g=e.value)==null?void 0:g.width)||0,y=((S=e.value)==null?void 0:S.height)||0;u.lineWidth=12,u.strokeStyle="gray",u.clearRect(0,0,l,y);const{x:_,y:s,width:p,height:c}=e.value.getBoundingClientRect(),$={x:_,y:s},h={x:e.value.offsetWidth/p,y:e.value.offsetHeight/c};n.connections.forEach(F=>{const W=v(F.start),D=v(F.end);n.drawFn(u,m(W,$,h),m(D,$,h))})},d=()=>{requestAnimationFrame(()=>{a(),d()})},f=()=>{if(!e.value)return;const{width:u,height:l}=e.value.getBoundingClientRect();e.value.height=l,e.value.width=u};let i;return A(()=>{!e.value||(f(),r.value=e.value.getContext("2d"),d(),i=new ResizeObserver(f),i.observe(e.value))}),J(()=>{i.disconnect()}),(u,l)=>(x(),C("canvas",{ref_key:"canvas",ref:e},null,512))}});var O;(function(t){t.Mouse="node-point:mouse"})(O||(O={}));const $e=t=>{if(!!t)return"$el"in t?t.$el:t},we=(t,n=window)=>{const{mouse:e}=Z(n),r=(a,d)=>{const f=a.points[d];if(!f)throw new Error(`Point ${d} not found in ${a}`);return f.el?f.el:null},o=a=>a===O.Mouse?e.value:r(a.node,a.point),v=a=>a.map(({start:d,end:f})=>({start:o(d)||{x:0,y:0},end:o(f)||{x:0,y:0}}));return{connectionPoints:N(()=>v(t.value))}},Ce=t=>{const n=(s,p)=>c=>{s.points[p].el=$e(c)},e=(s,p,c)=>typeof s=="string"?!1:s.node===p&&s.point===c,r=(s,p)=>t.value.find(({start:c})=>e(c,s,p)),o=(s,p)=>t.value.find(({start:c})=>e(c,s,p)),v=(s,p)=>r(s,p)||o(s,p),m=(s,p,c,$)=>t.value.find(({start:h,end:g})=>typeof h!="string"&&typeof g!="string"&&(!s||s===h.node)&&(!p||p===h.point)&&(!c||c===g.node)&&(!$||$===g.point)),a=w(),d=()=>{t.value=t.value.filter(s=>s!==a.value),a.value=void 0};return{registerPoint:n,getConnection:v,getConnectionStart:r,getConnectionEnd:o,connectFrom:(s,p)=>{a.value&&d(),a.value={start:{node:s,point:p},end:O.Mouse},t.value.push(a.value)},connectTo:(s,p)=>{!a.value||(a.value.end={node:s,point:p},a.value=void 0)},disconnect:(s,p,c,$)=>{t.value=t.value.filter(({start:h,end:g})=>!(e(h,s,p)&&e(g,c,$)))},disconnectSymmetric:(s,p,c,$)=>{t.value=t.value.filter(({start:h,end:g})=>!(e(h,s,p)&&e(g,c,$))&&!(e(h,c,$)&&e(g,s,p)))},disconnectStart:(s,p)=>{t.value=t.value.filter(({start:c})=>!e(c,s,p))},disconnectEnd:(s,p)=>{t.value=t.value.filter(({end:c})=>!e(c,s,p))},searchConnection:m}};const be=B({props:{nodes:{type:Array,required:!0},connections:{type:Array,required:!0},moveButton:{type:String,default:"right"}},emits:["update:nodes","update:connections","update:mouse"],setup(t,{emit:n}){const e=t,[r]=X(e,"nodes",n),[o]=X(e,"connections",n),v=w(),{connectionPoints:m}=we(o,v.value);return(a,d)=>(x(),V(me,{moveButton:t.moveButton,class:"nodes"},{default:M(()=>[q(ge,{nodes:b(r),"onUpdate:nodes":d[0]||(d[0]=f=>ie(r)?r.value=f:null)},{node:M(({node:f,index:i,listeners:u})=>[R(a.$slots,"node",L(T({node:f,index:i,dragListeners:u})))]),"node-content":M(({node:f,index:i})=>[R(a.$slots,"node-content",L(T({node:f,index:i})))]),_:3},8,["nodes"]),q(xe,{connections:b(m),ref_key:"connectionsRef",ref:v,class:"nodes__connections-canvas"},null,8,["connections"])]),_:3},8,["moveButton"]))}});var ke=(t,n)=>{const e=t.__vccOpts||t;for(const[r,o]of n)e[r]=o;return e};const Re={},Me={class:"nodes-demo-header"},Se={class:"nodes-demo-header__top"},Be=k("div",{class:"nodes-demo-header__bottom"},[k("a",{href:"https://github.com/m0ksem/vue-nodes"},"Github")],-1);function Ee(t,n){return x(),C("div",Me,[k("div",Se,[R(t.$slots,"default")]),Be])}var Ne=ke(Re,[["render",Ee]]);const Pe={class:"demo-node"},Le={key:0,class:"demo-node__header"},Te={class:"demo-node__main"},He={class:"demo-node__inputs"},qe={class:"demo-node__content"},Fe={class:"demo-node__outputs"},De=B({props:{title:{type:String,required:!1,default:""}},setup(t){return(n,e)=>(x(),C("div",Pe,[t.title?(x(),C("div",Le,H(t.title),1)):E("",!0),k("div",Te,[k("div",He,[R(n.$slots,"inputs")]),k("div",qe,[R(n.$slots,"default")]),k("div",Fe,[R(n.$slots,"outputs")])])]))}});const ee=B({props:{color:{type:String,required:!0},title:{type:String,required:!1,default:""},right:{type:Boolean,required:!1,default:!1}},emits:["circle-click","register-point"],setup(t,{emit:n}){const e=w();return I(e,r=>{r&&n("register-point",r)}),(r,o)=>(x(),C("div",{class:ae(["demo-button",{"demo-button--right":t.right}])},[t.right?R(r.$slots,"default",{key:0},()=>[Q(H(t.title),1)]):E("",!0),k("div",{class:"demo-button__circle",onClick:o[0]||(o[0]=v=>r.$emit("circle-click")),style:U({background:t.color}),ref_key:"circleRef",ref:e},null,4),t.right?E("",!0):R(r.$slots,"default",{key:1},()=>[Q(H(t.title),1)])],2))}});const Oe=k("h1",null,"Vue nodes demo",-1),We=k("p",null,"This is a math example, where you can create math expressions.",-1),Ye=k("p",null,'You have two "Number" inputs and can connect them trough math nodes.',-1),Ae={key:0},Ie=["onUpdate:modelValue"],Ue=B({setup(t){const n=w([{position:{x:-300,y:-100},math:"input",title:"Number",points:{output:{type:"output"}},value:0},{position:{x:-300,y:100},math:"input",title:"Number",points:{output:{type:"output"}},value:0},{position:{x:0,y:100},math:"+",title:"Sum",points:{input1:{type:"input",title:"Number"},input2:{type:"input",title:"Number"},output:{type:"output"}}},{position:{x:0,y:-100},math:"*",title:"Mul",points:{input1:{type:"input",title:"Number"},input2:{type:"input",title:"Number"},output:{type:"output"}}},{position:{x:150,y:0},math:"print",title:"Output",points:{input:{type:"input"}}}]),e=w([]),{registerPoint:r,connectFrom:o,connectTo:v,searchConnection:m,disconnectEnd:a}=Ce(e),d=()=>{const i=e.value.find(l=>typeof l.end!="string"&&l.end.node.math==="print"),u=l=>{if(l===void 0||typeof l.end=="string"||typeof l.start=="string")return 0;const y=l.start.node;if(y.math==="+"){const _=u(m(void 0,"output",y,"input1")),s=u(m(void 0,"output",y,"input2"));return _===void 0||s===void 0?0:Number(_)+Number(s)}if(y.math==="*"){const _=u(m(void 0,"output",y,"input1")),s=u(m(void 0,"output",y,"input2"));return _===void 0||s===void 0?0:Number(_)*Number(s)}if(y.math==="input")return y.value};return u(i)},f=N(()=>d());return(i,u)=>(x(),C(P,null,[q(Ne,null,{default:M(()=>[Oe,We,Ye]),_:1}),q(be,{nodes:n.value,"onUpdate:nodes":u[0]||(u[0]=l=>n.value=l),connections:e.value,"onUpdate:connections":u[1]||(u[1]=l=>e.value=l)},{"node-content":M(({node:l})=>[q(De,{title:l.title},{inputs:M(()=>[(x(!0),C(P,null,z(l.points,(y,_)=>(x(),C(P,{key:_},[y.type==="input"?(x(),V(ee,{key:0,onRegisterPoint:s=>b(r)(l,_)(s),onCircleClick:s=>{b(a)(l,_),b(v)(l,_)},color:"linear-gradient(145deg, #ff4e50, #f9d423)",title:y.title},{default:M(()=>[l.math==="print"?(x(),C("div",Ae,H(b(f)),1)):E("",!0)]),_:2},1032,["onRegisterPoint","onCircleClick","title"])):E("",!0)],64))),128))]),outputs:M(()=>[(x(!0),C(P,null,z(l.points,(y,_)=>(x(),C(P,{key:_},[y.type==="output"?(x(),V(ee,{key:0,onRegisterPoint:s=>b(r)(l,_)(s),onCircleClick:s=>b(o)(l,_),color:"linear-gradient(to right, #1d976c, #93f9b9)",title:y.title,right:""},{default:M(()=>[l.value!==void 0?le((x(),C("input",{key:0,"onUpdate:modelValue":s=>l.value=s},null,8,Ie)),[[ce,l.value]]):E("",!0)]),_:2},1032,["onRegisterPoint","onCircleClick","title"])):E("",!0)],64))),128))]),_:2},1032,["title"])]),_:1},8,["nodes","connections"])],64))}});de(Ue).mount("#app");
